<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather Dashboard</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { text-align: center; color: white; margin-bottom: 30px; }
        .search-box {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            gap: 10px;
        }
        .search-box input {
            flex: 1; padding: 15px; border: none; border-radius: 10px; font-size: 16px;
        }
        .search-box button {
            padding: 15px 30px; border: none; border-radius: 10px;
            background: #667eea; color: white; cursor: pointer; transition: 0.3s;
        }
        .main-weather {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px; margin-bottom: 30px; color: white;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .temperature { font-size: 5em; font-weight: 300; }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px; margin-bottom: 30px;
        }
        .stat-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px; color: white; text-align: center;
        }
        .forecast {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px; color: white;
        }
        .forecast-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px; margin-top: 20px;
        }
        .forecast-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px; padding: 15px; text-align: center;
        }
    </style>
</head>
<body>
        <div id="spinner" style="display:none; text-align:center; margin:20px;">
            <div style="display:inline-block; width:40px; height:40px; border:4px solid #667eea; border-top:4px solid #fff; border-radius:50%; animation:spin 1s linear infinite;"></div>
        </div>
        <style>
        @keyframes spin {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(360deg);}
        }
        </style>
        <div class="container">
        <div class="header">
            <h1>Weather Dashboard</h1>
            <p id="date"></p>
        </div>

        <div class="search-box">
            <input type="text" placeholder="Search city logic coming soon..." id="cityInput">
            <button>Search</button>
        </div>

        <div class="main-weather">
            <div class="location" id="city">Detecting location...</div>
            <div class="weather-info">
                <div class="temp-display">
                    <div class="temperature" id="temperature">--°C</div>
                    <div class="weather-desc" id="condition">Please allow location access</div>
                </div>
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card"><h3>Feels Like</h3><div class="value">--</div></div>
            <div class="stat-card"><h3>Humidity</h3><div class="value">--</div></div>
            <div class="stat-card"><h3>Wind</h3><div class="value">--</div></div>
            <div class="stat-card"><h3>Pressure</h3><div class="value">--</div></div>
            <div class="stat-card"><h3>Visibility</h3><div class="value">--</div></div>
            <div class="stat-card"><h3>UV Index</h3><div class="value">--</div></div>
        </div>

        <div class="forecast">
            <h2>7-Day Forecast</h2>
            <div class="forecast-grid" id="forecastGrid">
                </div>
        </div>
    </div>

    <script>
        // REPLACE THE STRING BELOW WITH YOUR KEY
        const KEY = 'https://api.openweathermap.org/data/3.0/onecall?lat=33.44&lon=-94.04&exclude=hourly,daily&appid={API key}'; 

        window.onload = function() {
            updateDate();
            getUserLocation();
        };

        function updateDate() {
            const now = new Date();
            document.getElementById('date').textContent = now.toLocaleDateString(undefined, { 
                weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' 
            });
        }

        function getUserLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(position => {
                    const { latitude, longitude } = position.coords;
                    fetchWeatherData(latitude, longitude);
                    updateCityName(latitude, longitude);
                }, () => {
                    document.getElementById('city').textContent = "Location Access Denied";
                });
            }
        }

        async function updateCityName(lat, lon) {
            try {
                const res = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
                const data = await res.json();
                const city = data.address.city || data.address.town || data.address.village || "Unknown";
                document.getElementById('city').textContent = `${city}, ${data.address.country}`;
            } catch (e) { console.error(e); }
        }

        async function fetchWeatherData(lat, lon) {
            const url = `https://api.openweathermap.org/data/3.0/onecall?lat=${lat}&lon=${lon}&units=metric&exclude=minutely,hourly&appid=${KEY}`;
            showSpinner();
            try {
                const response = await fetch(url);
                const data = await response.json();
                // Current
                document.getElementById('temperature').textContent = `${Math.round(data.current.temp)}°C`;
                document.getElementById('condition').textContent = data.current.weather[0].description;
                // Stats
                const stats = document.querySelectorAll('.stat-card .value');
                stats[0].textContent = `${Math.round(data.current.feels_like)}°`;
                stats[1].textContent = `${data.current.humidity}%`;
                stats[2].textContent = `${data.current.wind_speed} m/s`;
                stats[3].textContent = `${data.current.pressure} hPa`;
                stats[4].textContent = `${(data.current.visibility / 1000).toFixed(1)} km`;
                stats[5].textContent = data.current.uvi;
                renderForecast(data.daily);
            } catch (error) {
                console.error("Error:", error);
                document.getElementById('condition').textContent = "API Error - Check Key";
            } finally {
                hideSpinner();
            }
                function showSpinner() {
                    document.getElementById('spinner').style.display = 'block';
                }
                function hideSpinner() {
                    document.getElementById('spinner').style.display = 'none';
                }
        }

        function renderForecast(dailyData) {
            const grid = document.getElementById('forecastGrid');
            grid.innerHTML = ''; 

            dailyData.slice(1, 8).forEach(day => {
                const d = new Date(day.dt * 1000);
                const name = d.toLocaleDateString(undefined, { weekday: 'short' });
                const icon = `https://openweathermap.org/img/wn/${day.weather[0].icon}.png`;

                grid.innerHTML += `
                    <div class="forecast-card">
                        <div class="day">${name}</div>
                        <img src="${icon}" alt="icon">
                        <div class="temps">
                            <span class="high">${Math.round(day.temp.max)}°</span>
                            <span class="low" style="opacity:0.6">${Math.round(day.temp.min)}°</span>
                        </div>
                    </div>
                `;
            });
        }
    document.getElementById('cityInput').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        searchCityWeather();
    }
});
document.querySelector('.search-box button').addEventListener('click', searchCityWeather);

async function searchCityWeather() {
    const city = document.getElementById('cityInput').value.trim();
    if (!city) return;
    showSpinner();
    try {
        // Use OpenWeatherMap Geocoding API
        const geoRes = await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${encodeURIComponent(city)}&limit=1&appid=${KEY}`);
        const geoData = await geoRes.json();
        if (geoData.length === 0) {
            document.getElementById('city').textContent = 'City not found';
            hideSpinner();
            return;
        }
        const { lat, lon, name, country } = geoData[0];
        fetchWeatherData(lat, lon);
        document.getElementById('city').textContent = `${name}, ${country}`;
    } catch (e) {
        document.getElementById('city').textContent = 'Error fetching city';
        hideSpinner();
    }
}
    </script>
</body>
</html>